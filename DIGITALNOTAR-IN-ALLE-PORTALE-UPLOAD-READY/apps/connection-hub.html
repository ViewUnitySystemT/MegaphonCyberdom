<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connection Hub</title>
    <link rel="stylesheet" href="../styles.css">
    <style>
        body { 
            font-family: var(--font-family); 
            background-color: var(--background); 
            color: var(--on-background); 
            padding: 20px; 
        }
        .connection-container { 
            max-width: 1000px; 
            margin: 0 auto; 
            background: var(--surface); 
            border-radius: var(--radius-lg); 
            box-shadow: var(--shadow-md); 
            padding: 30px; 
        }
        h1 { 
            color: var(--primary); 
            text-align: center; 
            margin-bottom: 30px; 
        }
        .connection-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .connection-card { 
            background: var(--surface-variant); 
            border-radius: var(--radius-md); 
            padding: 20px; 
            border: 2px solid var(--outline); 
            transition: all 0.3s ease; 
            cursor: pointer; 
        }
        .connection-card:hover { 
            border-color: var(--primary); 
            transform: translateY(-2px); 
            box-shadow: var(--shadow-lg); 
        }
        .connection-card.active { 
            border-color: var(--primary); 
            background: var(--primary-container); 
        }
        .connection-header { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            margin-bottom: 10px; 
        }
        .connection-icon { 
            font-size: 2rem; 
        }
        .connection-title { 
            font-size: 1.2rem; 
            font-weight: bold; 
            color: var(--on-surface); 
        }
        .connection-status { 
            margin-left: auto; 
            width: 12px; 
            height: 12px; 
            border-radius: 50%; 
            background: var(--success); 
        }
        .connection-status.offline { 
            background: var(--error); 
        }
        .connection-status.unknown { 
            background: var(--warning); 
        }
        .connection-description { 
            color: var(--on-surface-variant); 
            margin-bottom: 15px; 
        }
        .connection-features { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 5px; 
            margin-bottom: 15px; 
        }
        .feature-tag { 
            background: var(--primary); 
            color: var(--on-primary); 
            padding: 2px 8px; 
            border-radius: 12px; 
            font-size: 0.8rem; 
        }
        .connection-actions { 
            display: flex; 
            gap: 10px; 
            flex-wrap: wrap; 
        }
        .btn { 
            padding: 8px 16px; 
            border: none; 
            border-radius: var(--radius-sm); 
            cursor: pointer; 
            font-size: 0.9rem; 
            display: flex; 
            align-items: center; 
            gap: 5px; 
            transition: all 0.3s ease; 
            flex: 1; 
            justify-content: center; 
        }
        .btn-primary { 
            background-color: var(--primary); 
            color: var(--on-primary); 
        }
        .btn-secondary { 
            background-color: var(--secondary); 
            color: var(--on-secondary); 
        }
        .btn-success { 
            background-color: var(--success); 
            color: var(--on-success); 
        }
        .btn:hover { 
            opacity: 0.9; 
            transform: translateY(-1px); 
        }
        .btn:disabled { 
            opacity: 0.5; 
            cursor: not-allowed; 
            transform: none; 
        }
        .discovery-section { 
            margin-top: 30px; 
            padding: 20px; 
            background: var(--surface-variant); 
            border-radius: var(--radius-md); 
        }
        .discovery-section h3 { 
            margin-bottom: 15px; 
            display: flex; 
            align-items: center; 
            gap: 10px; 
        }
        .discovered-devices { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 15px; 
            margin-top: 15px; 
        }
        .device-card { 
            background: var(--surface); 
            padding: 15px; 
            border-radius: var(--radius-sm); 
            border: 1px solid var(--outline); 
        }
        .device-header { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            margin-bottom: 10px; 
        }
        .device-name { 
            font-weight: bold; 
        }
        .device-type { 
            font-size: 0.8rem; 
            color: var(--on-surface-variant); 
        }
        .device-signal { 
            margin-left: auto; 
            display: flex; 
            align-items: center; 
            gap: 5px; 
        }
        .signal-bars { 
            display: flex; 
            gap: 2px; 
        }
        .signal-bar { 
            width: 3px; 
            background: var(--success); 
            border-radius: 1px; 
        }
        .signal-bar:nth-child(1) { height: 4px; }
        .signal-bar:nth-child(2) { height: 6px; }
        .signal-bar:nth-child(3) { height: 8px; }
        .signal-bar:nth-child(4) { height: 10px; }
        .device-actions { 
            display: flex; 
            gap: 5px; 
            margin-top: 10px; 
        }
        .btn-small { 
            padding: 5px 10px; 
            font-size: 0.8rem; 
            flex: 1; 
        }
        .scanning-indicator { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            padding: 10px; 
            background: var(--primary-container); 
            border-radius: var(--radius-sm); 
            margin-bottom: 15px; 
        }
        .scanning-dot { 
            width: 8px; 
            height: 8px; 
            border-radius: 50%; 
            background: var(--primary); 
            animation: scanning 1.5s infinite; 
        }
        @keyframes scanning { 
            0%, 100% { 
                opacity: 0.3; 
                transform: scale(0.8); 
            } 
            50% { 
                opacity: 1; 
                transform: scale(1.2); 
            } 
        }
        .advanced-section { 
            margin-top: 30px; 
            padding: 20px; 
            background: var(--surface-variant); 
            border-radius: var(--radius-md); 
        }
        .advanced-section h3 { 
            margin-bottom: 15px; 
            display: flex; 
            align-items: center; 
            gap: 10px; 
        }
        .advanced-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 15px; 
        }
        .advanced-card { 
            background: var(--surface); 
            padding: 15px; 
            border-radius: var(--radius-sm); 
            border: 1px solid var(--outline); 
            text-align: center; 
        }
        .advanced-icon { 
            font-size: 2rem; 
            margin-bottom: 10px; 
        }
        .advanced-title { 
            font-weight: bold; 
            margin-bottom: 5px; 
        }
        .advanced-desc { 
            font-size: 0.9rem; 
            color: var(--on-surface-variant); 
            margin-bottom: 10px; 
        }
    </style>
</head>
<body>
    
        <header class="top-app-bar">
            <div class="top-app-bar-content">
                <button class="icon-button" onclick="window.history.back()" title="Zur√ºck" title="Action Button">
                    <svg class="icon" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                </button>
                <h1 class="top-app-bar-title">Navigation</h1>
                <div class="top-app-bar-actions"><button class="icon-button" onclick="window.history.forward()" title="Vorw√§rts" title="Action Button">
                        <svg class="icon" viewBox="0 0 24 24"><path d="M4 11v2h12.17l-5.59 5.59L12 20l8-8-8-8-1.41 1.41L16.17 11H4z"/></svg>
                    </button>
                    
                    <button class="icon-button" onclick="window.history.forward()" title="Vorw√§rts" title="Action Button">
                        <svg class="icon" viewBox="0 0 24 24"><path d="M4 11v2h12.17l-5.59 5.59L12 20l8-8-8-8-1.41 1.41L16.17 11H4z"/></svg>
                    </button>
                </div>
            </div>
        </header>
        <main class="main-content">

    <div class="connection-container">
        <h1>üîó Connection Hub - Alle Verbindungsarten</h1>
        
        <!-- Main Connection Types -->
        <div class="connection-grid">
            <!-- WebRTC Connection -->
            <div class="connection-card" data-type="webrtc">
                <div class="connection-header">
                    <div class="connection-icon">üé•</div>
                    <div class="connection-title">WebRTC</div>
                    <div class="connection-status" id="webrtcStatus"></div>
                </div>
                <div class="connection-description">
                    Direkte Peer-to-Peer Video- und Audio-Verbindungen ohne Server
                </div>
                <div class="connection-features">
                    <span class="feature-tag">Video-Calls</span>
                    <span class="feature-tag">Audio-Calls</span>
                    <span class="feature-tag">Screen-Share</span>
                    <span class="feature-tag">Echtzeit</span>
                </div>
                <div class="connection-actions">
                    <button class="btn btn-primary" onclick="startWebRTC()" title="Action Button">
                        üé• Video-Call
                    </button>
                    <button class="btn btn-secondary" onclick="startAudioCall()" title="Action Button">
                        üéµ Audio-Call
                    </button>
                    <button class="btn btn-success" onclick="startScreenShare()" title="Action Button">
                        üñ•Ô∏è Screen-Share
                    </button>
                </div>
            </div>

            <!-- WiFi Direct -->
            <div class="connection-card" data-type="wifi">
                <div class="connection-header">
                    <div class="connection-icon">üì∂</div>
                    <div class="connection-title">WiFi Direct</div>
                    <div class="connection-status" id="wifiStatus"></div>
                </div>
                <div class="connection-description">
                    Direkte WiFi-Verbindung zwischen Ger√§ten ohne Router
                </div>
                <div class="connection-features">
                    <span class="feature-tag">P2P</span>
                    <span class="feature-tag">Schnell</span>
                    <span class="feature-tag">Sicher</span>
                    <span class="feature-tag">Lokal</span>
                </div>
                <div class="connection-actions">
                    <button class="btn btn-primary" onclick="startWiFiDirect()" title="Action Button">
                        üì∂ Starten
                    </button>
                    <button class="btn btn-secondary" onclick="scanWiFi()" title="Action Button">
                        üîç Scannen
                    </button>
                    <button class="btn btn-success" onclick="shareWiFi()" title="Action Button">
                        üì§ Teilen
                    </button>
                </div>
            </div>

            <!-- Bluetooth -->
            <div class="connection-card" data-type="bluetooth">
                <div class="connection-header">
                    <div class="connection-icon">üîµ</div>
                    <div class="connection-title">Bluetooth</div>
                    <div class="connection-status" id="bluetoothStatus"></div>
                </div>
                <div class="connection-description">
                    Bluetooth-Verbindungen f√ºr Dateien, Audio und Ger√§te
                </div>
                <div class="connection-features">
                    <span class="feature-tag">Dateien</span>
                    <span class="feature-tag">Audio</span>
                    <span class="feature-tag">Niedrige Latenz</span>
                    <span class="feature-tag">Energiesparend</span>
                </div>
                <div class="connection-actions">
                    <button class="btn btn-primary" onclick="startBluetooth()" title="Action Button">
                        üîµ Verbinden
                    </button>
                    <button class="btn btn-secondary" onclick="scanBluetooth()" title="Action Button">
                        üîç Scannen
                    </button>
                    <button class="btn btn-success" onclick="shareBluetooth()" title="Action Button">
                        üìÅ Dateien
                    </button>
                </div>
            </div>

            <!-- NFC -->
            <div class="connection-card" data-type="nfc">
                <div class="connection-header">
                    <div class="connection-icon">üì°</div>
                    <div class="connection-title">NFC</div>
                    <div class="connection-status" id="nfcStatus"></div>
                </div>
                <div class="connection-description">
                    Near Field Communication f√ºr schnelle Verbindungen
                </div>
                <div class="connection-features">
                    <span class="feature-tag">Sofort</span>
                    <span class="feature-tag">Ber√ºhrung</span>
                    <span class="feature-tag">Sicher</span>
                    <span class="feature-tag">Einfach</span>
                </div>
                <div class="connection-actions">
                    <button class="btn btn-primary" onclick="startNFC()" title="Action Button">
                        üì° Aktivieren
                    </button>
                    <button class="btn btn-secondary" onclick="writeNFC()" title="Action Button">
                        ‚úçÔ∏è Schreiben
                    </button>
                    <button class="btn btn-success" onclick="readNFC()" title="Action Button">
                        üìñ Lesen
                    </button>
                </div>
            </div>

            <!-- Matrix Integration -->
            <div class="connection-card" data-type="matrix">
                <div class="connection-header">
                    <div class="connection-icon">üîó</div>
                    <div class="connection-title">Matrix</div>
                    <div class="connection-status" id="matrixStatus"></div>
                </div>
                <div class="connection-description">
                    Federierte Kommunikation mit erweiterten Features
                </div>
                <div class="connection-features">
                    <span class="feature-tag">Federation</span>
                    <span class="feature-tag">E2EE</span>
                    <span class="feature-tag">Rooms</span>
                    <span class="feature-tag">Bridges</span>
                </div>
                <div class="connection-actions">
                    <button class="btn btn-primary" onclick="openMatrix()" title="Action Button">
                        üîó √ñffnen
                    </button>
                    <button class="btn btn-secondary" onclick="createMatrixRoom()" title="Action Button">
                        üè† Raum erstellen
                    </button>
                    <button class="btn btn-success" onclick="joinMatrixRoom()" title="Action Button">
                        üö™ Beitreten
                    </button>
                </div>
            </div>

            <!-- QR Code -->
            <div class="connection-card" data-type="qr">
                <div class="connection-header">
                    <div class="connection-icon">üîó</div>
                    <div class="connection-title">QR-Code</div>
                    <div class="connection-status" id="qrStatus"></div>
                </div>
                <div class="connection-description">
                    Schnelle Verbindung √ºber QR-Code-Scanning
                </div>
                <div class="connection-features">
                    <span class="feature-tag">Schnell</span>
                    <span class="feature-tag">Universal</span>
                    <span class="feature-tag">Kontaktlos</span>
                    <span class="feature-tag">Einfach</span>
                </div>
                <div class="connection-actions">
                    <button class="btn btn-primary" onclick="openQRScanner()" title="Action Button">
                        üì± Scanner
                    </button>
                    <button class="btn btn-secondary" onclick="openQRGenerator()" title="Action Button">
                        üîó Generator
                    </button>
                    <button class="btn btn-success" onclick="shareQR()" title="Action Button">
                        üì§ Teilen
                    </button>
                </div>
            </div>
        </div>

        <!-- Device Discovery -->
        <div class="discovery-section">
            <h3>üîç Ger√§te-Entdeckung</h3>
            <div class="scanning-indicator" id="scanningIndicator" style="display: block;">
                <div class="scanning-dot"></div>
                <div class="scanning-dot"></div>
                <div class="scanning-dot"></div>
                <span>Suche nach verf√ºgbaren Ger√§ten...</span>
            </div>
            <div class="connection-actions" style="margin-bottom: 15px;">
                <button class="btn btn-primary" onclick="startDiscovery()" title="Action Button">
                    üîç Alle Scannen
                </button>
                <button class="btn btn-secondary" onclick="stopDiscovery()" title="Action Button">
                    ‚èπÔ∏è Stoppen
                </button>
                <button class="btn btn-success" onclick="refreshDiscovery()" title="Action Button">
                    üîÑ Aktualisieren
                </button>
            </div>
            <div class="discovered-devices" id="discoveredDevices">
                <p style="text-align: center; color: var(--on-surface-variant);">
                    Keine Ger√§te gefunden. Klicke auf "Alle Scannen" um zu starten.
                </p>
            </div>
        </div>

        <!-- Advanced Features -->
        <div class="advanced-section">
            <h3>‚ö° Erweiterte Features</h3>
            <div class="advanced-grid">
                <div class="advanced-card" onclick="openMeshNetwork()">
                    <div class="advanced-icon">üï∏Ô∏è</div>
                    <div class="advanced-title">Mesh-Netzwerk</div>
                    <div class="advanced-desc">Multi-Hop-Verbindungen</div>
                </div>
                <div class="advanced-card" onclick="openTunnel()">
                    <div class="advanced-icon">üöá</div>
                    <div class="advanced-title">Tunnel</div>
                    <div class="advanced-desc">VPN-√§hnliche Verbindungen</div>
                </div>
                <div class="advanced-card" onclick="openRelay()">
                    <div class="advanced-icon">üîÑ</div>
                    <div class="advanced-title">Relay-Server</div>
                    <div class="advanced-desc">Verbindungen √ºber Server</div>
                </div>
                <div class="advanced-card" onclick="openBridge()">
                    <div class="advanced-icon">üåâ</div>
                    <div class="advanced-title">Bridge</div>
                    <div class="advanced-desc">Protokoll-Br√ºcken</div>
                </div>
                <div class="advanced-card" onclick="openProxy()">
                    <div class="advanced-icon">üîÑ</div>
                    <div class="advanced-title">Proxy</div>
                    <div class="advanced-desc">Proxy-Verbindungen</div>
                </div>
                <div class="advanced-card" onclick="openTor()">
                    <div class="advanced-icon">üßÖ</div>
                    <div class="advanced-title">Tor-Netzwerk</div>
                    <div class="advanced-desc">Anonyme Verbindungen</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class ConnectionHub {
            constructor() {
                this.isDiscovering = false;
                this.discoveredDevices = [];
                this.connectionStatuses = {};
                
                this.init();
            }

            init() {
                this.checkConnectionCapabilities();
                this.setupEventListeners();
                this.startPeriodicStatusCheck();
            }

            async checkConnectionCapabilities() {
                // Check WebRTC
                this.connectionStatuses.webrtc = this.checkWebRTC();
                
                // Check WiFi Direct (experimental)
                this.connectionStatuses.wifi = await this.checkWiFiDirect();
                
                // Check Bluetooth
                this.connectionStatuses.bluetooth = await this.checkBluetooth();
                
                // Check NFC
                this.connectionStatuses.nfc = this.checkNFC();
                
                // Check Matrix
                this.connectionStatuses.matrix = await this.checkMatrix();
                
                // Check QR Code
                this.connectionStatuses.qr = this.checkQRCode();
                
                this.updateStatusIndicators();
            }

            checkWebRTC() {
                return !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia && 
                         window.RTCPeerConnection);
            }

            async checkWiFiDirect() {
                // Experimental WiFi Direct API
                return !!(navigator.wifiDirect || navigator.wifi);
            }

            async checkBluetooth() {
                return !!(navigator.bluetooth && navigator.bluetooth.requestDevice);
            }

            checkNFC() {
                return !!('NDEFReader' in window);
            }

            async checkMatrix() {
                // Check if Matrix is available
                try {
                    const response = await fetch('/matrix-status');
                    return response.ok;
                } catch {
                    return false;
                }
            }

            checkQRCode() {
                return !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia);
            }

            updateStatusIndicators() {
                Object.keys(this.connectionStatuses).forEach(type => {
                    const statusElement = document.getElementById(`${type}Status`);
                    if (statusElement) {
                        statusElement.className = `connection-status ${this.connectionStatuses[type] ? '' : 'offline'}`;
                    }
                });
            }

            setupEventListeners() {
                // Handle connection card clicks
                document.querySelectorAll('.connection-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const type = card.dataset.type;
                        this.handleConnectionType(type);
                    });
                });
            }

            handleConnectionType(type) {
                // Remove active class from all cards
                document.querySelectorAll('.connection-card').forEach(card => {
                    card.classList.remove('active');
                });
                
                // Add active class to clicked card
                document.querySelector(`[data-type="${type}"]`).classList.add('active');
            }

            async startDiscovery() {
                if (this.isDiscovering) return;
                
                this.isDiscovering = true;
                document.getElementById('scanningIndicator').style.display = 'flex';
                
                // Simulate device discovery
                await this.discoverWiFiDevices();
                await this.discoverBluetoothDevices();
                await this.discoverNFCDevices();
                
                this.renderDiscoveredDevices();
                
                this.isDiscovering = false;
                document.getElementById('scanningIndicator').style.display = 'none';
            }

            async discoverWiFiDevices() {
                if (!this.connectionStatuses.wifi) return;
                
                // Simulate WiFi device discovery
                const wifiDevices = [
                    { name: 'iPhone 15 Pro', type: 'wifi-direct', signal: 4, mac: 'AA:BB:CC:DD:EE:01' },
                    { name: 'Samsung Galaxy S24', type: 'wifi-direct', signal: 3, mac: 'AA:BB:CC:DD:EE:02' },
                    { name: 'MacBook Pro', type: 'wifi-direct', signal: 5, mac: 'AA:BB:CC:DD:EE:03' },
                    { name: 'Windows Laptop', type: 'wifi-direct', signal: 2, mac: 'AA:BB:CC:DD:EE:04' }
                ];
                
                this.discoveredDevices.push(...wifiDevices);
            }

            async discoverBluetoothDevices() {
                if (!this.connectionStatuses.bluetooth) return;
                
                // Simulate Bluetooth device discovery
                const bluetoothDevices = [
                    { name: 'AirPods Pro', type: 'bluetooth', signal: 4, mac: 'AA:BB:CC:DD:EE:05' },
                    { name: 'Sony WH-1000XM4', type: 'bluetooth', signal: 3, mac: 'AA:BB:CC:DD:EE:06' },
                    { name: 'Bluetooth Mouse', type: 'bluetooth', signal: 5, mac: 'AA:BB:CC:DD:EE:07' },
                    { name: 'Smart Watch', type: 'bluetooth', signal: 2, mac: 'AA:BB:CC:DD:EE:08' }
                ];
                
                this.discoveredDevices.push(...bluetoothDevices);
            }

            async discoverNFCDevices() {
                if (!this.connectionStatuses.nfc) return;
                
                // Simulate NFC device discovery
                const nfcDevices = [
                    { name: 'NFC Tag #1', type: 'nfc', signal: 4, mac: 'NFC:001' },
                    { name: 'Smart Card', type: 'nfc', signal: 3, mac: 'NFC:002' },
                    { name: 'Payment Card', type: 'nfc', signal: 5, mac: 'NFC:003' }
                ];
                
                this.discoveredDevices.push(...nfcDevices);
            }

            renderDiscoveredDevices() {
                const container = document.getElementById('discoveredDevices');
                
                if (this.discoveredDevices.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: var(--on-surface-variant);">Keine Ger√§te gefunden</p>';
                    return;
                }
                
                container.innerHTML = this.discoveredDevices.map(device => `
                    <div class="device-card">
                        <div class="device-header">
                            <div>
                                <div class="device-name">${device.name}</div>
                                <div class="device-type">${device.type.toUpperCase()}</div>
                            </div>
                            <div class="device-signal">
                                <div class="signal-bars">
                                    ${Array.from({length: 4}, (_, i) => 
                                        `<div class="signal-bar" style="opacity: ${i < device.signal ? 1 : 0.3}"></div>`
                                    ).join('')}
                                </div>
                                <span>${device.signal}/4</span>
                            </div>
                        </div>
                        <div class="device-actions">
                            <button class="btn btn-primary btn-small" onclick="connectToDevice('${device.mac}', '${device.type}')" title="Action Button">
                                üîó Verbinden
                            </button>
                            <button class="btn btn-secondary btn-small" onclick="infoDevice('${device.mac}')" title="Action Button">
                                ‚ÑπÔ∏è Info
                            </button>
                            <button class="btn btn-success btn-small" onclick="shareDevice('${device.mac}')" title="Action Button">
                                üì§ Teilen
                            </button>
                        </div>
                    </div>
                `).join('');
            }

            stopDiscovery() {
                this.isDiscovering = false;
                document.getElementById('scanningIndicator').style.display = 'none';
            }

            refreshDiscovery() {
                this.discoveredDevices = [];
                this.startDiscovery();
            }

            startPeriodicStatusCheck() {
                setInterval(() => {
                    this.checkConnectionCapabilities();
                }, 30000); // Check every 30 seconds
            }
        }

        // Global functions
        function startWebRTC() {
            window.location.href = 'peerlink-full.html';
        }

        function startAudioCall() {
            window.location.href = 'peerlink-full.html?mode=audio';
        }

        function startScreenShare() {
            window.location.href = 'conference-full.html?mode=screenshare';
        }

        function startWiFiDirect() {
            if (navigator.wifiDirect) {
                navigator.wifiDirect.requestConnection().then(() => {
                    alert('WiFi Direct-Verbindung gestartet!');
                }).catch(err => {
                    alert('WiFi Direct-Fehler: ' + err.message);
                });
            } else {
                alert('WiFi Direct wird nicht unterst√ºtzt');
            }
        }

        function scanWiFi() {
            alert('WiFi-Scan wird implementiert...');
        }

        function shareWiFi() {
            alert('WiFi-Sharing wird implementiert...');
        }

        function startBluetooth() {
            if (navigator.bluetooth) {
                navigator.bluetooth.requestDevice({
                    acceptAllDevices: true
                }).then(device => {
                    alert(`Bluetooth-Ger√§t verbunden: ${device.name}`);
                }).catch(err => {
                    alert('Bluetooth-Fehler: ' + err.message);
                });
            } else {
                alert('Bluetooth wird nicht unterst√ºtzt');
            }
        }

        function scanBluetooth() {
            alert('Bluetooth-Scan wird implementiert...');
        }

        function shareBluetooth() {
            alert('Bluetooth-Datei-Sharing wird implementiert...');
        }

        function startNFC() {
            if ('NDEFReader' in window) {
                const reader = new NDEFReader();
                reader.scan().then(() => {
                    alert('NFC-Scanner gestartet!');
                }).catch(err => {
                    alert('NFC-Fehler: ' + err.message);
                });
            } else {
                alert('NFC wird nicht unterst√ºtzt');
            }
        }

        function writeNFC() {
            alert('NFC-Schreiben wird implementiert...');
        }

        function readNFC() {
            alert('NFC-Lesen wird implementiert...');
        }

        function openMatrix() {
            window.location.href = 'matrix-client.html';
        }

        function createMatrixRoom() {
            alert('Matrix-Raum erstellen wird implementiert...');
        }

        function joinMatrixRoom() {
            const roomId = prompt('Matrix-Raum-ID eingeben:');
            if (roomId) {
                window.location.href = `matrix-client.html?room=${roomId}`;
            }
        }

        function openQRScanner() {
            window.location.href = 'qr-scanner.html';
        }

        function openQRGenerator() {
            window.location.href = 'qr-generator.html';
        }

        function shareQR() {
            alert('QR-Code-Sharing wird implementiert...');
        }

        function startDiscovery() {
            window.connectionHub.startDiscovery();
        }

        function stopDiscovery() {
            window.connectionHub.stopDiscovery();
        }

        function refreshDiscovery() {
            window.connectionHub.refreshDiscovery();
        }

        function connectToDevice(mac, type) {
            alert(`Verbinde mit ${type}-Ger√§t: ${mac}`);
        }

        function infoDevice(mac) {
            alert(`Ger√§te-Info f√ºr: ${mac}`);
        }

        function shareDevice(mac) {
            alert(`Teile Ger√§t: ${mac}`);
        }

        // Advanced features
        function openMeshNetwork() {
            alert('Mesh-Netzwerk wird implementiert...');
        }

        function openTunnel() {
            alert('Tunnel-Verbindung wird implementiert...');
        }

        function openRelay() {
            alert('Relay-Server wird implementiert...');
        }

        function openBridge() {
            alert('Protokoll-Br√ºcke wird implementiert...');
        }

        function openProxy() {
            alert('Proxy-Verbindung wird implementiert...');
        }

        function openTor() {
            alert('Tor-Netzwerk wird implementiert...');
        }

        // Initialize when page loads
        window.addEventListener('DOMContentLoaded', () => {
            window.connectionHub = new ConnectionHub();
        });
    </script>
        </main>
    
        <script>
            // Browser Navigation Enhancement
            document.addEventListener('DOMContentLoaded', function() {
                // Navigation-Status anzeigen
                updateNavigationStatus();
                
                // Popstate Event f√ºr Browser-Navigation
                window.addEventListener('popstate', function(event) {
                    console.log('Browser Navigation:', event.state);
                    updateNavigationStatus();
                });
                
                // Navigation-Status aktualisieren
                function updateNavigationStatus() {
                    const canGoBack = window.history.length > 1;
                    const canGoForward = window.history.length > 1; // Vereinfacht
                    
                    // Back-Button aktivieren/deaktivieren
                    const backButtons = document.querySelectorAll('button[onclick*="history.back"]');
                    backButtons.forEach(btn => {
                        btn.disabled = !canGoBack;
                        btn.style.opacity = canGoBack ? '1' : '0.5';
                    });
                    
                    // Forward-Button aktivieren/deaktivieren
                    const forwardButtons = document.querySelectorAll('button[onclick*="history.forward"]');
                    forwardButtons.forEach(btn => {
                        btn.disabled = !canGoForward;
                        btn.style.opacity = canGoForward ? '1' : '0.5';
                    });
                }
                
                // Globale Navigation-Funktionen
                window.goBack = function() {
                    if (window.history.length > 1) {
                        window.history.back();
                    }
                };
                
                window.goForward = function() {
                    window.history.forward();
                };
                
                window.goHome = function() {
                    window.location.href = '/';
                };
            });
        </script>

    </body>
</html>



